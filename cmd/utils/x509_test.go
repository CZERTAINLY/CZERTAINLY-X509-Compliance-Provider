package utils

import (
	"encoding/base64"
	"github.com/zmap/zcrypto/x509"
	"testing"
)

func TestGetPublicKeySize(t *testing.T) {
	certificate := "MIIDfjCCAmagAwIBAgIUFanTqP1qmACQDMYlbsvJhyvjvIYwDQYJKoZIhvcNAQELBQAwPjELMAkGA1UEBhMCQ1oxGzAZBgNVBAgMEkhsYXZuaSBtZXN0byBQcmFoYTESMBAGA1UEBwwJSGx1Ym9jZXB5MB4XDTIyMDYyMjE0NTE1OFoXDTIzMDYyMjE0NTE1OFowPjELMAkGA1UEBhMCQ1oxGzAZBgNVBAgMEkhsYXZuaSBtZXN0byBQcmFoYTESMBAGA1UEBwwJSGx1Ym9jZXB5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyTZ8rfZAzjtgfat1jq6s37Xtx8lITNta4fqAhRlhsfg+bpP3nd7K8kB7U4AV37FZPjM/wbIJOdJ+dR5nkqPCPDJ7q3e9nYX1D5t2rwloCNH1lyDpA5osBV+ohgsR27dOEeKqfN+u16Ev1S7PS+h8MXIOPjuSvjh7/lVZp6jDZwj0MjwJVbTALlkuO9vJj0FnOzmpekWFz/o+/dfnJiZuto97hl0H1O4uBs19uduqpW3T3HQVMNjRMiftGyqlkpE0MSnbPT59xyKpzx/KN1zV57c/QEOOZfOArlRhocKQF7dPqTAS/AN69mv3QAQs6CDlcp6GktHocHvdXsrLXGQ2kQIDAQABo3QwcjAdBgNVHQ4EFgQUaQNqw0xnagL/rud9VntFrRvN2cUwHwYDVR0jBBgwFoAUaQNqw0xnagL/rud9VntFrRvN2cUwDgYDVR0PAQH/BAQDAgWgMCAGA1UdJQEB/wQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjANBgkqhkiG9w0BAQsFAAOCAQEANuxV/KL25wCTDqzCj3GOwheRv/iZmFq0p29i4W5Q8au19BUtCI9FNeB+9mAS95YV7U/QhigfjfYNV/B4B/SbXs4ttkeHI7QRDR0TCsxJHhrYmXolkyIHVjo0bmH87ekccSZjaTUvMcryqd1vIzBXmHpDQeYgQ78XJPPA3liulPLmmftb4lSYrZ3kP2E743O2GRaPnkE9K2fjf5vk8trzkeb2mn1qP/tywlcFud+bMdXyp9OI38WD/FxgE1NYrz83RXJH6J5kGZ+Am9tGEZHiAwtBvAa0n8YmkL3h4HI74YIKPtOeOuU4YX17tOqzWru2QNCxZFCE0uC7guX/SwtWjQ=="
	block, _ := base64.StdEncoding.DecodeString(certificate)
	parsed, _ := x509.ParseCertificate(block)
	if GetPublicKeySize(parsed) != 2048 {
		t.Error("Failed when calculating the key size")
	}
}
